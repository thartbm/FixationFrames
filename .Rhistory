col=c('orange', 'purple'),
lwd=2, bty='n' )
df3 <- read.csv("data/apparent/exp_1/marius/responses.csv", stringsAsFactors = FALSE)
df3$percept <- df3$percept_abs * 2 * df$xfactor
df2 <- read.csv("data/apparent/exp_5/test/responses.csv", stringsAsFactors = FALSE)
df2$percept <- df2$percept_abs * 2 * df2$xfactor
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1,1))
# amplitude plot
for (df in list(df3, df2)) {
plot(NULL,NULL,
xlim=c(0,5), ylim=c(0,5),
xlab="amplitude",ylab="percept",
ax=F,bty='n', asp=1)
lines(x=c(0,5), y=c(0,5), lty=2, col='gray')
dfa <- df[which(df$framelag == 0), ]
for (stimtype in c('classicframe', 'apparentframe')) {
ftdf <- dfa[which(dfa$stimtype == stimtype), ]
avg <- aggregate(percept ~ amplitude, data = ftdf, FUN = mean)
CI  <- aggregate(percept ~ amplitude, data = ftdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$amplitude, rev(avg$amplitude)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$amplitude, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(1,2,3,4))
axis(side=2, at=c(1,2,3,4))
legend( x=0, y=5,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
4/30
layout(mat=matrix(c(1), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- c(df3, df2)[df_no]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 4/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
layout(mat=matrix(c(1), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 4/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 4/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 4/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
framelags <- sort(unique(dfl$framelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
df2
View(df2)
framelags <- sort(unique(dfl$framelag))
framelags
FMA <- 4
FMD <- 0.2
lagdurations <- abs(framelags/30)
pause_duration
frame_pos <- FMA / (FMD) * (lagdurations - pause_duration)
frame_pos
diff(c(frame_pos[2:7], 4-frame_pos[2:7]))
diff(c(frame_pos, 4-frame_pos))
(4-frame_pos) - frame_pos
frame_pos
frame_pos[2:7]
mfp <- frame_pos[2:7]
2-mfp
mfp+2
4 - (mfp+2)
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 4/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
framelags <- sort(unique(dfl$framelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- list(0.1, 4/30)[[df_no]]
dfl <- df[which(df$amplitude == 4), ]
framelags <- sort(unique(dfl$framelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
probeLagLookUp <- function(framelags, FMD, FMA, pause_duration=NULL) {
# framelags <- c(0,2,3,4,5,6,7,8,9,10,11)
#
# FMD <- 0.2
# FMA <- 4
lagdurations <- abs(framelags/30) # framelags are at 30 Hz indeed
probe_duration <- (2/30)/2 # check this!
if (is.null(pause_duration)) {
pause_duration <- (4/30)/2 # errrr?
}
probe_spacing <- c()
for (lagdur in lagdurations) {
probe_onset <- lagdur - probe_duration
if (probe_onset < pause_duration) {
probe_offset <- lagdur + probe_duration
if (probe_offset <= pause_duration) {
probe_spacing <- c(probe_spacing, FMA)
} else {
static_part <- (pause_duration - probe_onset) / (2*probe_duration)
dynamic_duration <- probe_offset - pause_duration
dynamic_part <- dynamic_duration / (2*probe_duration)
frame_pos <- FMA / (FMD) * (dynamic_duration/2)
probe_space <- (static_part * FMA) + (dynamic_part * diff(c(frame_pos, FMA - frame_pos)))
probe_spacing <- c(probe_spacing, probe_space)
}
} else {
frame_pos <- FMA / (FMD) * (lagdur - pause_duration)
probe_spacing <- c(probe_spacing, 4-frame_pos+2)
}
}
look.up <-  data.frame( framelag = framelags,
lagduration = lagdurations,
probespacing = probe_spacing )
return(look.up)
}
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- list(0.1, 4/30)[[df_no]]
dfl <- df[which(df$amplitude == 4), ]
framelags <- sort(unique(dfl$framelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
print(look.up)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
probeLagLookUp <- function(framelags, FMD, FMA, pause_duration=NULL) {
# framelags <- c(0,2,3,4,5,6,7,8,9,10,11)
#
# FMD <- 0.2
# FMA <- 4
lagdurations <- abs(framelags/30) # framelags are at 30 Hz indeed
probe_duration <- (2/30)/2 # check this!
if (is.null(pause_duration)) {
pause_duration <- (4/30)/2 # errrr?
}
probe_spacing <- c()
for (lagdur in lagdurations) {
probe_onset <- lagdur - probe_duration
if (probe_onset < pause_duration) {
probe_offset <- lagdur + probe_duration
if (probe_offset <= pause_duration) {
probe_spacing <- c(probe_spacing, FMA)
} else {
static_part <- (pause_duration - probe_onset) / (2*probe_duration)
dynamic_duration <- probe_offset - pause_duration
dynamic_part <- dynamic_duration / (2*probe_duration)
frame_pos <- FMA / (FMD) * (dynamic_duration/2)
probe_space <- (static_part * FMA) + (dynamic_part * diff(c(frame_pos, FMA - frame_pos)))
probe_spacing <- c(probe_spacing, probe_space)
}
} else {
frame_pos <- FMA / (FMD) * (lagdur - pause_duration)
probe_spacing <- c(probe_spacing, diff(c(frame_pos, 4-frame_pos)))
}
}
look.up <-  data.frame( framelag = framelags,
lagduration = lagdurations,
probespacing = probe_spacing )
return(look.up)
}
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 4/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
framelags <- sort(unique(dfl$framelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
df_no <- 2
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 4/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
framelags <- sort(unique(dfl$framelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
look.up
look.up$lagduration
ld <- look.up$lagduration
ls
ld
FMA
FMD
FMA/FMD
ld - pause_duration
pause_duration
ld
layout(mat=matrix(c(1,2), nrow=1, ncol=2), widths=c(1))
for (df_no in c(1,2)) {
df <- list(df3, df2)[[df_no]]
FMD <- c(0.3, 0.2)[df_no]
pause_duration <- c(0.1, 2/30)[df_no]
dfl <- df[which(df$amplitude == 4), ]
framelags <- sort(unique(dfl$framelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = FMD,
FMA = 4,
pause_duration = pause_duration)
dfl$relprobedist <- NA
for (fl in framelags) {
dfl$relprobedist[which(dfl$framelag == fl)] <- look.up$probespacing[which(look.up$framelag == fl)]
}
plot(NULL,NULL,
xlim=c(-4,4), ylim=c(-4,4),
xlab="probe offset in frame",ylab="percept",
ax=F,bty='n')
lines(x=c(-4,4), y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4), y=c(0,0), lty=2, col='gray')
lines(x=c(0,-0), y=c(-4,4), lty=2, col='gray')
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfl[which(dfl$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(c(avg$relprobedist, rev(avg$relprobedist)),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines(avg$relprobedist, avg$percept, type='b', lwd=2, col=color)
}
axis(side=1, at=c(-4, -2, 0, 2, 4))
axis(side=2, at=c(-4, -2, 0, 2, 4))
legend( x=-4, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
