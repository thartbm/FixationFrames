xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(4,2,0,-2,-4))
} else {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(-4,-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-4, -2, 0, 2, 4))
}
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2), nrow=2, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-9,9), ylim=c(-4,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(4,2,0,-2,-4))
} else {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(-4,-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-4, -2, 0, 2, 4))
}
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2), nrow=2, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-9,9), ylim=c(-4,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
# print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(4,2,0,-2,-4))
} else {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(-4,-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-4, -2, 0, 2, 4))
}
1/5
0.2 * 144
28.8/6
probeLagLookUp(framelags = c(0,2,5,8,11), FMD=0.6, FMA=4, pause_duration = 4/30)
probeLagLookUp(framelags = c(0,2,3,4,5), FMD=0.2, FMA=4, pause_duration = 4/30)
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2,3), nrow=2, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4, 0.6)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-9,9), ylim=c(-4,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
# print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(4,2,0,-2,-4))
} else {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(-4,-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-4, -2, 0, 2, 4))
}
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2,3), nrow=3, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4, 0.6)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-9,9), ylim=c(-4,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
# print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(4,2,0,-2,-4))
} else {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(-4,-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-4, -2, 0, 2, 4))
}
probeLagLookUp(framelags = c(0,2,3,4,5), FMD=0.2, FMA=4, pause_duration = 4/30)
probeLagLookUp(framelags = c(0,2,5,8,11), FMD=0.6, FMA=4, pause_duration = 4/30)
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2,3), nrow=3, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4, 0.6)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-9,9), ylim=c(-4,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
# print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(4,2,0,-2,-4))
} else {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(-4,-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-4, -2, 0, 2, 4))
}
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2,3), nrow=3, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4, 0.6)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-7,7), ylim=c(-2,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
# print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(4,2,0,-2,-4))
} else {
axis(side=1, at=c(-4,-2,0,2,4)+x_offset, labels=c(-4,-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-4, -2, 0, 2, 4))
}
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2,3), nrow=3, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4, 0.6)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-7,7), ylim=c(-2,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
# print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2)+x_offset, labels=c(4,2,0,-2))
} else {
axis(side=1, at=c(-2,0,2,4)+x_offset, labels=c(-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-9.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-2, 0, 2, 4))
}
dfB <- read.csv("data/apparent/exp_6/mariusB/responses.csv", stringsAsFactors = FALSE)
# dfB$percept <- dfB$percept_abs * 2 * dfB$xfactor
layout(mat=matrix(c(1,2,3), nrow=3, ncol=1), heights=c(1,1))
for (movdur in c(0.2, 0.4, 0.6)) {
# dfD <- dfB[which(dfB$period == movdur), ]
# print(dim(dfD))
plot(NULL,NULL,
xlim=c(-7,7), ylim=c(-2,4),
xlab="probe offset in frame [dva]",ylab="percept [dva]",
ax=F,bty='n')
for (rel in c('lead','lag')) {
idx <- which(dfB$period == movdur & dfB$test == rel)
# print(idx)
dfP <- dfB[idx, ]
# print(dim(dfP))
x_offset <- list('lead' = -4.5,
'lag'  =  4.5)[[rel]]
lines(x=c(x_offset, x_offset), y=c(-4,4), lty=2, col='gray')
lines(x=-sign(x_offset)*c(-4,4)+x_offset, y=c(-4,4), lty=2, col='gray')
lines(x=c(-4,4)+x_offset, y=c(0,0), lty=2, col='gray')
framelags <- sort(unique(dfP$probelag))
look.up <- probeLagLookUp(framelags = framelags,
FMD = movdur,
FMA = 4,
pause_duration = 4/30)
# print(look.up)
dfP$relprobedist <- NA
for (pl in framelags) {
dfP$relprobedist[which(dfP$probelag == pl)] <- look.up$probespacing[which(look.up$framelag == pl)]
}
for (stimtype in c('classicframe', 'apparentframe')) {
ltdf <- dfP[which(dfP$stimtype == stimtype), ]
avg <- aggregate(percept ~ relprobedist, data = ltdf, FUN = mean)
CI  <- aggregate(percept ~ relprobedist, data = ltdf, FUN = Reach::getConfidenceInterval, method='b')
# print(avg)
# print(CI$percept)
color = list('classicframe'='orange', 'apparentframe'='purple')[[stimtype]]
polygon(x_offset + (-1*sign(x_offset)*c(avg$relprobedist, rev(avg$relprobedist))),
c(CI$percept[,1], rev(CI$percept[,2])),
col=adjustcolor(color, alpha.f=0.2), border=NA)
lines((-1*sign(x_offset)*avg$relprobedist)+x_offset, avg$percept, type='b', lwd=2, col=color)
}
if (rel=='lag') {
axis(side=1, at=c(-4,-2,0,2)+x_offset, labels=c(4,2,0,-2))
} else {
axis(side=1, at=c(-2,0,2,4)+x_offset, labels=c(-2,0,2,4))
}
text(x=x_offset, y=5, labels=sprintf('%ss - %d ms frame movement', rel, round(movdur*1000)), xpd=TRUE)
if (movdur == 0.2 && rel == 'lead') {
legend( x=-7.5, y=4,
legend=c("continuous motion", "apparent motion"),
col=c('orange', 'purple'),
lwd=2, bty='n' )
}
}
axis(side=2, at=c(-2, 0, 2, 4))
}
